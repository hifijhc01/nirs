<?xml version="1.0" encoding="UTF-8"?>
<datasources xmlns="http://www.jboss.org/ironjacamar/schema">
    <!-- 
       애플리케이션과 함께 배포되는 Datasource 설정 파일입니다.
       서버 설정을 건드리지 않고 WAR 파일 안에 포함되어 배포됩니다.
    -->
    <datasource jndi-name="java:jboss/datasources/TodoDS" pool-name="TodoDS" enabled="true" use-java-context="true">
        <!-- 환경 변수 치환 구문 사용 -->
        <connection-url>jdbc:postgresql://${env.POSTGRESQL_SERVICE_HOST:postgresql}:${env.POSTGRESQL_SERVICE_PORT:5432}/${env.POSTGRESQL_DATABASE:tododb}</connection-url>
        
        <!-- 드라이버 이름은 EAP가 기본 제공하는 'postgresql' 사용 -->
        <driver>postgresql</driver>
        
        <security>
            <user-name>${env.POSTGRESQL_USERNAME:todo}</user-name>
            <password>${env.POSTGRESQL_PASSWORD:password}</password>
        </security>
        
        <validation>
            <valid-connection-checker class-name="org.jboss.jca.adapters.jdbc.extensions.postgres.PostgreSQLValidConnectionChecker"/>
            <validate-on-match>true</validate-on-match>
            <background-validation>false</background-validation>
            <exception-sorter class-name="org.jboss.jca.adapters.jdbc.extensions.postgres.PostgreSQLExceptionSorter"/>
        </validation>
    </datasource>
</datasources>
